package api

import "github.com/valocode/bubbly/ent"

type (
	VulnerabilityGetRequest struct{}

	VulnerabilityGetResponse struct {
		Vulnerabilities []*Vulnerability `json:"vulnerabilities"`
	}

	Vulnerability struct {
		ent.VulnerabilityModelRead `validate:"required"`
	}

	VulnerabilityCreate struct {
		ent.VulnerabilityModelCreate `validate:"required" mapstructure:",squash"`
		Patch                        *VulnerabilityPatch `json:"patch,omitempty" mapstructure:"patch"`
	}

	VulnerabilityPatch struct {
		Note *string `json:"note,omitempty" validate:"required" mapstructure:"note"`
	}
)
