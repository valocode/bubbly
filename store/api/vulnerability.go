package api

import "github.com/valocode/bubbly/ent"

type (
	VulnerabilityGetRequest struct{}

	VulnerabilityGetResponse struct {
		Vulnerabilities []*Vulnerability `json:"vulnerabilities"`
	}

	Vulnerability struct {
		*ent.VulnerabilityModelRead
	}

	VulnerabilityCreateRequest struct {
		Vulnerability *VulnerabilityCreate `json:"vulnerability,omitempty" validate:"required"`
	}

	VulnerabilityCreate struct {
		*ent.VulnerabilityModelCreate
		Component *ComponentCreate `json:"component,omitempty"  validate:"dive,required"`
	}

	VulnerabilityCreateResponse struct {
		Vulnerability *ent.VulnerabilityModelRead `json:"vulnerability"`
	}

	// VulnerabilityCreate struct {
	// 	// TODO: should only have review if this is going into a release
	// 	// Review allows to add a review immeditely to this vulnerability
	// 	// in the context of a release
	// 	// Review *ent.VulnerabilityReviewModelCreate `json:"review,omitempty"`
	// }

	VulnerabilityCreatePatch struct {
		ent.VulnerabilityModelCreate `validate:"required" mapstructure:",squash"`
		Patch                        *VulnerabilityPatch `json:"patch,omitempty" mapstructure:"patch"`
	}

	VulnerabilityPatch struct {
		Note *string `json:"note,omitempty" validate:"required" mapstructure:"note"`
	}
)
